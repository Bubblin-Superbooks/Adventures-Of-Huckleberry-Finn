/*
 * CircleType 0.34
 * Peter Hrynkow
 * Copyright 2013, Licensed GPL & MIT
 *
 */

$.fn.circleType=function(a){var b={dir:1,position:"relative"};return"function"!=typeof $.fn.lettering?void console.log("Lettering.js is required"):this.each(function(){a&&$.extend(b,a);var h,i,c=this,d=180/Math.PI,e=parseInt($(c).css("line-height"),10),f=parseInt($(c).css("font-size"),10),g=c.innerHTML.replace(/^\s+|\s+$/g,"").replace(/\s/g,"&nbsp;");c.innerHTML=g,$(c).lettering(),c.style.position=b.position,h=c.getElementsByTagName("span"),i=Math.floor(h.length/2);var j=function(){var g,j,k,m,n,o,p,q,a=0,i=0;for(g=0;g<h.length;g++)a+=h[g].offsetWidth;for(j=a/Math.PI/2+e,b.fluid&&!b.fitText?b.radius=Math.max(c.offsetWidth/2,j):b.radius||(b.radius=j),k=b.dir===-1?"center "+(-b.radius+e)/f+"em":"center "+b.radius/f+"em",m=b.radius-e,g=0;g<h.length;g++)n=h[g],i+=n.offsetWidth/2/m*d,n.rot=i,i+=n.offsetWidth/2/m*d;for(g=0;g<h.length;g++)n=h[g],o=n.style,p=-i*b.dir/2+n.rot*b.dir,q="rotate("+p+"deg)",o.position="absolute",o.left="50%",o.marginLeft=-(n.offsetWidth/2)/f+"em",o.webkitTransform=q,o.MozTransform=q,o.OTransform=q,o.msTransform=q,o.transform=q,o.webkitTransformOrigin=k,o.MozTransformOrigin=k,o.OTransformOrigin=k,o.msTransformOrigin=k,o.transformOrigin=k,b.dir===-1&&(o.bottom=0);b.fitText&&("function"!=typeof $.fn.fitText?console.log("FitText.js is required when using the fitText option"):($(c).fitText(),$(window).resize(function(){l()}))),l()},k=function(a){var b=document.documentElement,c=a.getBoundingClientRect();return{top:c.top+window.pageYOffset-b.clientTop,left:c.left+window.pageXOffset-b.clientLeft,height:c.height}},l=function(){var d,a=k(h[i]),b=k(h[0]);d=a.top<b.top?b.top-a.top+b.height:a.top-b.top+b.height,c.style.height=d+"px"};b.fluid&&!b.fitText&&$(window).resize(function(){j()}),"complete"!==document.readyState?(c.style.visibility="hidden",$(window).load(function(){c.style.visibility="visible",j()})):j()})};